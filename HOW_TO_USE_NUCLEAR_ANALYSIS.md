# 如何使用核物理分析功能

## 🎉 新功能：自动计算检测

现在 Oppenheimer AI **可以在对话中自动检测并执行核物理计算**！

## 使用方式

### ✅ 方式 1: 直接对话（推荐）

只需在对话中输入问题，Oppenheimer 会自动检测并执行计算：

#### 示例 1: 结合能计算

**您输入**：
```
请计算 U-235 的结合能
```

**Oppenheimer 会自动**：
1. 检测到 "计算" 和 "U-235"
2. 提取 Z=92, A=235
3. 执行 `get_nuclear_properties()` 计算
4. 在回答中包含计算结果和详细推导

**回答示例**：
```
[思考过程显示...]

根据半经验质量公式，U-235 的结合能计算如下：

[自动计算结果显示]
结合能: 1780.03 MeV
每核子结合能: 7.57 MeV/nucleon
质量亏损: 0.001911 u
裂变能量: 178.5 MeV

详细计算过程：
B = a_v*A - a_s*A^(2/3) - a_c*Z²/A^(1/3) - a_a*(A-2Z)²/A + δ
B = 15.8*235 - 18.3*235^(2/3) - 0.714*92²/235^(1/3) - 23.2*(235-184)²/235 + 12/√235
...
```

#### 示例 2: 半衰期查询（使用 NPAT）

**您输入**：
```
U-238 的半衰期是多少？
```

**Oppenheimer 会自动**：
1. 检测到 "半衰期" 和 "U-238"
2. 提取 Z=92, A=238
3. 调用 `get_nuclide_data_npat()` 查询 NPAT 数据库
4. 在回答中包含半衰期数据

**回答示例**：
```
[NPAT数据] U-238 半衰期: 4.47×10⁹ 年 (1.41×10¹⁷ 秒)
稳定性: 放射性

半衰期的定义是...
[详细解释]
```

#### 示例 3: 衰变链分析

**您输入**：
```
分析 U-238 在 1 年后的衰变链
```

**Oppenheimer 会自动**：
1. 检测到 "衰变链" 和 "U-238"
2. 提取时间 "1 年" = 31536000 秒
3. 调用 `analyze_decay_chain_npat()` 分析
4. 在回答中包含衰变链结果

#### 示例 4: 临界质量计算

**您输入**：
```
计算 U-235 的临界质量
```

**Oppenheimer 会自动**：
1. 检测到 "临界质量" 和 "U-235"
2. 调用 `calculate_critical_mass()` 计算
3. 在回答中包含临界质量和临界半径

**回答示例**：
```
[临界质量计算] U-235:
临界质量: 52.0 kg
临界半径: 8.7 cm
有效倍增因子 k_eff: 1.53

临界质量的计算基于四因子公式...
[详细推导]
```

### ✅ 方式 2: 使用 GUI 按钮（仍然可用）

界面顶部的按钮仍然可以使用：
- **BASIC ANALYSIS** - 基础分析
- **ADVANCED ANALYSIS** - 高级分析
- **CROSS SECTIONS** - 截面查询
- **CRITICAL MASS** - 临界质量

## 支持的自动计算类型

### 1. 基础核物理性质

**触发关键词**：
- "计算"、"求"、"分析"
- "结合能"、"binding energy"
- "质量"、"mass"、"properties"

**示例问题**：
- "请计算 U-235 的结合能"
- "What is the binding energy of Pu-239?"
- "分析 Fe-56 的核物理性质"

### 2. 半衰期查询（NPAT）

**触发关键词**：
- "半衰期"、"half-life"、"half life"
- "half_life"

**示例问题**：
- "U-238 的半衰期是多少？"
- "What is the half-life of Ra-226?"
- "Tell me the half-life of Th-232"

### 3. 衰变链分析（NPAT）

**触发关键词**：
- "衰变链"、"decay chain"
- "衰变"、"decay"

**示例问题**：
- "分析 U-238 在 1 年后的衰变链"
- "Calculate the decay chain of Ra-226 after 10 days"
- "U-235 的衰变过程"

### 4. 临界质量计算

**触发关键词**：
- "临界质量"、"critical mass"
- "临界"、"critical"

**示例问题**：
- "计算 U-235 的临界质量"
- "What is the critical mass of Pu-239?"
- "U-238 的临界半径是多少？"

### 5. 截面数据查询

**触发关键词**：
- "截面"、"cross section"、"cross-section"

**示例问题**：
- "U-235 的中子截面是多少？"
- "Show me the cross section data for Pu-239"

## 支持的核素格式

系统可以识别以下格式：
- `U-235` ✅
- `U235` ✅
- `Pu-239` ✅
- `Pu239` ✅
- `Ra-226` ✅

## 时间单位支持

在衰变链分析中，支持以下时间单位：
- 秒 (s, seconds, 秒)
- 小时 (h, hours, 小时)
- 天 (d, days, 天)
- 年 (y, years, 年)

**示例**：
- "分析 U-238 在 1 年后的衰变链"
- "Calculate decay chain after 10 days"
- "1000 秒后的衰变"

## 完整示例对话

### 示例 1: 结合能计算

**您**：
```
请计算 U-235 的结合能，并解释各项贡献
```

**Oppenheimer**：
```
[思考过程显示...]

[自动计算结果显示]
结合能: 1780.03 MeV
每核子结合能: 7.57 MeV/nucleon

根据半经验质量公式：

B = a_v*A - a_s*A^(2/3) - a_c*Z²/A^(1/3) - a_a*(A-2Z)²/A + δ

对于 U-235 (Z=92, A=235):

体积项: B_v = a_v × A = 15.8 × 235 = 3713.0 MeV
表面项: B_s = -a_s × A^(2/3) = -18.3 × 38.1 = -697.2 MeV
库仑项: B_c = -a_c × Z²/A^(1/3) = -0.714 × 8464/6.18 = -978.1 MeV
不对称项: B_a = -a_a × (A-2Z)²/A = -23.2 × 2601/235 = -257.3 MeV
配对项: B_p = 12/√A = 12/15.33 = 0.8 MeV (even-even)

总计: B = 3713.0 - 697.2 - 978.1 - 257.3 + 0.8 = 1780.03 MeV

[详细解释各项的物理意义...]
```

### 示例 2: 半衰期 + 衰变链

**您**：
```
U-238 的半衰期是多少？它在 100 年后的衰变链如何？
```

**Oppenheimer**：
```
[思考过程显示...]

[NPAT数据] U-238 半衰期: 4.47×10⁹ 年 (1.41×10¹⁷ 秒)
稳定性: 放射性

U-238 的半衰期约为 44.7 亿年，这是一个非常长的半衰期...

[NPAT衰变链分析] U-238 在 3153600000 秒后的衰变链分析已完成

U-238 的衰变链如下：
U-238 → Th-234 → Pa-234 → U-234 → ...

[详细分析每个步骤...]
```

## 技术细节

### 自动检测机制

系统会检测以下内容：
1. **计算请求关键词**：计算、求、分析、calculate、compute 等
2. **核素信息**：自动提取元素符号和质量数
3. **问题类型**：结合能、半衰期、衰变链、临界质量等
4. **时间信息**：自动提取并转换时间单位

### 计算结果整合

计算结果会自动添加到系统提示中，Oppenheimer 会在回答中：
- ✅ 引用计算结果
- ✅ 提供数学推导
- ✅ 解释物理意义
- ✅ 使用 NPAT/PyNE 数据（如果可用）

## 注意事项

1. **NPAT 数据库**：
   - 半衰期和衰变链功能需要 NPAT 数据库
   - 如果未下载，会显示错误提示
   - 运行 `python3 setup_npat_database.py` 下载数据

2. **核素识别**：
   - 系统支持常见元素符号
   - 如果元素未识别，会尝试使用通用方法

3. **计算精度**：
   - 基础计算使用半经验质量公式
   - NPAT 数据来自实验数据库
   - 结果可能有轻微差异

## 总结

✅ **现在可以直接在对话中使用**：
- 输入问题 → Oppenheimer 自动检测 → 自动计算 → 显示结果和推导

✅ **支持的自动计算**：
- 结合能计算
- 半衰期查询（NPAT）
- 衰变链分析（NPAT）
- 临界质量计算
- 截面数据查询

✅ **使用简单**：
- 只需自然语言提问
- 无需记住命令格式
- 自动识别核素和时间

现在您可以更自然地与 Oppenheimer 交互，就像与真正的核物理学家对话一样！

